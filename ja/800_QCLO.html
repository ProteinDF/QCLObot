

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ja" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="ja">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Automated calculation program QCLObot &mdash; QCLObot User&#39;s Manual 2022.2.3 ドキュメント</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="./"
    src="_static/documentation_options.js"></script>
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
  <script src="_static/jquery.js"></script>
  <script src="_static/underscore.js"></script>
  <script src="_static/doctools.js"></script>
  <script src="_static/translations.js"></script>
  <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  
  <script type="text/javascript" src="_static/js/theme.js"></script>

  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="index" title="索引" href="genindex.html" />
  <link rel="search" title="検索" href="search.html" />
  <link rel="prev" title="explanation of QCLObot-modeler YAML File" href="180_modeler_keyword.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> QCLObot User's Manual
              

              
            </a>

            
            
            
            <div class="version">
              2022.2.3
            </div>
            
            

            
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            <div>
              <select name="lang" onchange="location.href=value;">
                <option value="../en/800_QCLO.html">English</option>
                <option value="../ja/800_QCLO.html" selected>日本語</option>
              </select>
            </div>

            
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
          
          
          
          
          
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="10_Introduction.html">はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="20_install.html">QCLObotのインストール</a></li>
<li class="toctree-l1"><a class="reference internal" href="30_setup_model.html">計算モデルの設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="80_keyword.html">QCLObot YAML ファイル解説</a></li>
<li class="toctree-l1"><a class="reference internal" href="90_API.html">API for QCLObot</a></li>
<li class="toctree-l1"><a class="reference internal" href="90_API.html#qclobot-package">qclobot package</a></li>
<li class="toctree-l1"><a class="reference internal" href="120_tutorial_modeling.html">Setting up modeling proteins</a></li>
<li class="toctree-l1"><a class="reference internal" href="180_modeler_keyword.html">explanation of QCLObot-modeler YAML File</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Automated calculation program QCLObot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#automatic-computation-program-based-on-the-qclo-method-qclobot">automatic computation program based on the QCLO method QCLObot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">タンパク質全電子計算の収束過程</a></li>
<li class="toctree-l3"><a class="reference internal" href="#canonical-and-localized-orbitals">Canonical and Localized orbitals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#automatic-calculation-program-based-on-the-qclo-method">automatic calculation program based on the QCLO method</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">QCLObot User's Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
          <div class="rst-content">
            
            <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Automated calculation program QCLObot</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/800_QCLO.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
            <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
              <div itemprop="articleBody">
                
  <section id="automated-calculation-program-qclobot">
<h1>Automated calculation program QCLObot<a class="headerlink" href="#automated-calculation-program-qclobot" title="このヘッドラインへのパーマリンク"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="このヘッドラインへのパーマリンク"></a></h2>
<p>The canonical electronic state calculations of proteins is performed by using the ProteinDF program,
a program based on the density-functional molecular orbital method,
and the QCLObot program, an automated calculation method program.
The QCLObot creates the initial values for the execution of ProteinDF.
Upon execution of the QCLObot program, the ProteinDF program is obtained the initial guess
and the all-electron canonical calculation by the ProteinDF program is performed, according to the calculation playbook.</p>
<section id="automatic-computation-program-based-on-the-qclo-method-qclobot">
<h3>automatic computation program based on the QCLO method QCLObot<a class="headerlink" href="#automatic-computation-program-based-on-the-qclo-method-qclobot" title="このヘッドラインへのパーマリンク"></a></h3>
<p>QCLObot is an automated calculation program to assist in the calculation of giant system canonical molecular orbitals;
QCLOs are localized orbitals that are localized in one region but are close to canonical molecular orbitals in that region.
By cutting and pasting subunit QCLOs,
we can obtain good initial values for molecular orbital calculations in larger regions.
The QCLO method is a method to calculate canonical molecular orbitals of large systems by repeating the process of expanding the computational domain by obtaining the QCLO again.
This method enables us to perform precise quantum chemical calculations of functionally rich proteins in an easy and safe manner.</p>
</section>
<section id="id1">
<h3>タンパク質全電子計算の収束過程<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク"></a></h3>
<p>一般に、タンパク質やペプチド鎖のような大きな分子の電子状態は、
はじめから一点計算を行うことが困難です。
タンパク質をアミノ酸残基のような小さな分子片に分割して、
それらの計算で求められた解を基に徐々に大きなペプチド鎖を計算していくといった手法を用います。
本手法の概要を <a href="#qclosteps">Fig.  1</a> に示します。</p>
<figure class="align-center" id="id2">
<span id="qclosteps"></span><a class="reference internal image-reference" href="_images/QCLO_steps.png"><img alt="QCLO_steps.png" src="_images/QCLO_steps.png" style="width: 8cm;" /></a>
<figcaption>
<p><span class="caption-text">Fig. 1: タンパク質全電子計算収束過程の概要</span><a class="headerlink" href="#id2" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>ステップ1 ではタンパク質やペプチド鎖をアミノ酸残基1 残基ずつに分割し、これらの計算を行います。
ステップ2 ではステップ1 で計算された1 残基の結果をもとに、3 残基ずつの計算を実行します。
このようにステップ2 以降では重なりを持って切り出します。
同様にステップ3 ではステップ2 の3 残基の結果をもとに数残基のペプチド鎖の計算を実行します。
このとき、ペプチド鎖の両端は対応する2 残基、間は真ん中の1 残基の結果をつなげて、初期値を作成します。
このような操作を繰り返すことにより、次第にペプチド鎖の長さを延長して、
最終的に全タンパク質の計算を実行します。
この収束過程で作成される分子をフレーム分子とよびます。
なお、ステップ1ではHarrisの初期値、ステップ2ではステップ1で計算された電子密度を合成して初期値を作ります。
しかし、つなげる分子の数が多いほど誤差が蓄積しますし、
重なりを持たせているとはいえ、結合部分では比較的大きな誤差が生じます。
このような誤差は大きな分子の分子軌道計算には致命的な欠陥を生じることがあります。
そこで、ステップ3 以降では、新しい局在化軌道をベースにした初期値合成方法を使用します。</p>
</section>
<section id="canonical-and-localized-orbitals">
<h3>Canonical and Localized orbitals<a class="headerlink" href="#canonical-and-localized-orbitals" title="このヘッドラインへのパーマリンク"></a></h3>
<p>The representation of molecular orbitals has many degrees of freedom and
can be transformed into many things by unitary transformation.
Two representations of molecular orbitals are often used to exploit this property:
canonical orbitals, which are canonical orthogonal systems,
and localized orbitals, which are localized orbitals.
One is the canonical orbital, which is a canonical orthogonal system, and the other is the localized orbital.
Localized Orbitals are determined to be maximally localized in the narrowest space.
Localized orbitals are determined by the formulae of the localized orbitals proposed by Edmiston-Rüdenberg and Foster-Boys,
but there are also methods such as Pipek-Mezey's Population method and Gu's RMO method.
Both of these methods are formulated in such a way that the indices become larger as the orbits are localized in a particular space.
In particular, the orbitals localized by the Edmiston-Rüdenberg, Population, and RMO methods are generally localized around the nucleus,
the valence electrons involved in the bond are localized around the bond,
and the valence electrons not involved in the bond are localized in the form of so-called isolated electron pair orbitals.
This is why it is well known for its ability to match the chemist's intuition.</p>
<p>本システムでは、Edmiston-Rüdenberg法よりも高速な、Population 法とRMO法を採用しました。
ペプチド鎖の良い初期値を合成するために、ステップ3 以降では局在化軌道を用います。
分子軌道を局在した形で表現すれば、分子軌道を化学的によい近似で個別に取り扱うことができます。
つまり煩雑な手続きが必要ですが、局在化軌道が作られれば安全かつ自由に分子軌道を分離結合することが可能になります。
これにより精度の良い初期値を作成することができます。
この切り貼りに便利な軌道をその性質から、先に擬カノニカル局在化軌道(QCLO)と名付けました。
RMO法はまったく異なる計算方法ですが、特定の領域に局在化させた軌道を作成する方法で、基本的に取り扱い方は変わりません。
一般に、分子サイズが大きくなるほど、RMO法の方が高速に計算できます。
これらを用いて初期値を作成する方法は <a href="#qclofragment">Fig.  2</a> に示すように、
ペプチド鎖をアミノ酸残基の側鎖やアミノ酸をつなぐペプチド結合などの部分（これらをフラグメントと呼ぶ）に分割し、
フラグメントのみに広がり、かつフラグメントのカノニカル分子軌道に似た軌道を求め、
これらを組み合わせてペプチド鎖全体の分子軌道計算の初期値とする方法です。
局在化軌道を求めるには、計算目的となる分子の周辺の影響を取り込むため、
またペプチド結合の部分を厳密に表現するために3 残基以上のフレーム分子から出発します。
このフレーム分子においてペプチド鎖の場合のフラグメントは主鎖と側鎖の2 パターンに分類します。
こう分類することで本システムでは自動的にフラグメントに分けることができます。</p>
<figure class="align-center" id="id3">
<span id="qclofragment"></span><a class="reference internal image-reference" href="_images/QCLO_fragment.png"><img alt="QCLO_fragment.png" src="_images/QCLO_fragment.png" style="width: 8cm;" /></a>
<figcaption>
<p><span class="caption-text">Fig. 2: フレーム分子THR-VAL-GLUとフラグメント</span><a class="headerlink" href="#id3" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>QCLOおよびRMO作成の手順は以下の通りです。</p>
<ul class="simple">
<li><p>手順1 : フレーム分子毎の分子軌道計算</p></li>
</ul>
<p>フレーム分子の分子軌道計算を実行します。
フレーム分子の構造はペプチド鎖の相当部分と同じものを用い、
切断されたＮ末、C 末にそれぞれH、OH を付加します。ここで得られる軌道はフレーム分子全体に広がったカノニカル軌道です。</p>
<ul class="simple">
<li><p>手順2 : フレーム分子毎の局在化軌道計算</p></li>
</ul>
<p>手順1 で得られた分子軌道を個々の化学結合や孤立電子対に局在する分子軌道に変換します。QCLOとRMOではこの計算方法が異なります。</p>
<ul class="simple">
<li><p>手順3 : フラグメント毎の擬カノニカル局在化軌道計算</p></li>
</ul>
<p>手順2 で得られた軌道の中から各フラグメントに属す局在化軌道を選び出し、
それらの係数行列を使用してフレーム分子のKohn-Sham 行列（ab initio HF 法ならばFock行列）を
原子軌道ベースから局在化軌道ベースに変換します。
そうして作られたフラグメントのKohn-Sham 行列の固有値方程式を解くことで
フラグメントに局在しつつ、フラグメント全体に広がった軌道が求められます。
以上の手順1～3 でQCLOまたはRMOが得られます。
手順1～3 をすべてのフレーム分子とそのフラグメントで実行し、初期値は手順4 で作成します。</p>
<ul class="simple">
<li><p>手順4 :局在化軌道の結合</p></li>
</ul>
<p>手順3 で計算されたQCLOやRMOはフレーム分子毎に計算されています。
まず、手順1 で付加した原子H、OH の軌道成分は本来のペプチド鎖には存在しないため、取り除きます。
すべてのフラグメントのQCLOまたはRMOを組み合わせてペプチド鎖全体の軌道セットを作成します。
この軌道セットは規格直交化されていないため、ここでLöwdinの直交化を実行します。
Löwdin の直交化はもとの軌道をなるべく変えないように規格直交化を達成しますので、
得られた軌道は手順3 の軌道とほとんど変わりません。これによりペプチド鎖全体で規格直交したLCAO 行列が得られます。</p>
<p>手順1～4 の手順を組み合わせた方法を、タンパク質全電子計算の収束過程と呼びます。</p>
<section id="automatic-calculation-program-based-on-the-qclo-method">
<h4>automatic calculation program based on the QCLO method<a class="headerlink" href="#automatic-calculation-program-based-on-the-qclo-method" title="このヘッドラインへのパーマリンク"></a></h4>
<p>This is an automatic calculation function based on the QCLO method.
Using the fragment-by-fragment QCLO calculation results of the ProteinDF program,
It has the ability to generate initial guess (LCAO) for the ProteinDF program.</p>
<p>In the ProteinDF program, the Roothaan equation <span class="math notranslate nohighlight">\(FC=SC\epsilon\)</span> is solved
by using the converting matrix <span class="math notranslate nohighlight">\(X=U s^{-1/2}\)</span>.</p>
<ol class="arabic simple">
<li><p>Convert the Khon-Sham matrix based on Atomic orbital (AO) basis to an orthogonalized basis</p></li>
</ol>
<div class="math notranslate nohighlight">
\[F'=X^{t}FXC\]</div>
<ol class="arabic simple" start="2">
<li><p>KS 行列に対するレベルシフト</p></li>
</ol>
<div class="math notranslate nohighlight">
\[F'=F'+C'(C'*\beta)^{\dagger}\]</div>
<ol class="arabic simple" start="3">
<li><p>KS 行列の対角化し、直交化基底での係数行列を得る</p></li>
</ol>
<div class="math notranslate nohighlight">
\[F'C'=C'\epsilon'\]</div>
<ol class="arabic simple" start="4">
<li><p>係数行列を AO 基底に変換</p></li>
</ol>
<div class="math notranslate nohighlight">
\[C=XC'\]</div>
<p>QCLO 法の計算方法の概要を以下に示します。</p>
<ul class="simple">
<li><p>第1ステップ：</p></li>
</ul>
<p>普通の SCF MO 計算を全アミノ酸に対して行います。初期電子密度は、原子の電子密度から作成します。</p>
<ul class="simple">
<li><p>第2ステップ：</p></li>
</ul>
<p>初期電子密度は、第１ステップで得られたモノマーの電子密度を切り貼りする。
局在化軌道（LO）をフラグメントに振り分けた後、フラグメントの QCLO は、次の式によって求められます。
この固有方程式の解が QCLO です。</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F'=C_{LO}^{t}FC_{LO}\\F'C'=C'\epsilon'\end{aligned}\end{align} \]</div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(F\)</span> フレーム分子の Fock or Kohn-Sham 行列</div>
<div class="line"><span class="math notranslate nohighlight">\(C_LO\)</span> フラグメントに割り振られた LO の係数行列</div>
<div class="line"><span class="math notranslate nohighlight">\(F'\)</span> フラグメントの Fock or Kohn-Sham 行列（LO 基底）</div>
</div>
<ul class="simple">
<li><p>第3ステップ以降：</p></li>
</ul>
<p>第2ステップの QCLO を集めて初期値を作成する。
集められた QCLO は Löwdin変換によって直交化しなければなりませんが、
変換しても元の QCLO からはほとんど変化しません。
直交化された QCLO から、フラグメントに対する初期値が作成される。
フラグメントに対する Fock もしくは Kohn-Sham 行列は、以下の式で求められます。</p>
<div class="math notranslate nohighlight">
\[F'=C_{QCLO}^{t}FC_{QCLO}\]</div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(C_{QCLO}\)</span> QCLO の係数行列（原子軌道基底）</div>
</div>
<p>この解は、前のステップの QCLO で張られた空間における、第3ステップの QCLO です。
QCLO 法の処理フローを <a href="#qcloflow">Fig.  3</a>  に示します。</p>
<figure class="align-center" id="id4">
<span id="qcloflow"></span><img alt="QCLO_flow.png" src="_images/QCLO_flow.png" />
<figcaption>
<p><span class="caption-text">Fig. 3: QCLO法の処理フロー</span><a class="headerlink" href="#id4" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
</section>
</section>
</section>


              </div>
              
            </div>
            <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="180_modeler_keyword.html" class="btn btn-neutral float-left" title="explanation of QCLObot-modeler YAML File" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014-2020, Toshiyuki HIRANO.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
          </div>
        </div>

    </section>

  </div>
  

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
  
   

</body>

</html>